/** \file triangle.cpp
  Implementation of triangle.hpp.
  \author J. Houdayer
*/
#include "triangle.hpp"

/** Checks whether the integration scheme has correct barycentric coordinates. */
double scheme::check_unity() const
{
  double sum = 0;
  for (auto &i: data)
    sum += fabs(i.c1 + i.c2 + i.c3 - 1);
  return sum;
}

/** Checks whether the integration scheme has a unit global weight. */
double scheme::check_weights() const
{
  double sum = 0;
  for (auto &i: data)
    sum += i.weight;

  return fabs(sum - 1);
}

/** Checks whether the integration scheme is exact for x1^n1 x2^n2.
  x1, x2, x3 being the barycentric coordinates.
*/
double scheme::check_poly(const int n1, const int n2) const
{
  double sum = 0;
  for (auto &i: data)
    sum += i.weight * (pow(i.c1, n1) * pow(i.c2, n2));

  return fabs(1 - 2 * tgamma(n1+1) * tgamma(n2+1) / tgamma(n1+n2+3) / sum);
}

/** Checks whether the integration scheme is exact for x1^n, x2^n and x1^(n/2)x2^(n/2).
  x1, x2, x3 being the barycentric coordinates.
*/
double scheme::check_poly_auto() const
{ return check_poly(order, 0) + check_poly(0, order) + check_poly(order / 2, order / 2); }

/** Checks whether the weights of the integration scheme are ordered. */
int scheme::check_sorted() const
{
  double w = 0;
  int k = 0;
  for (auto &i: data) {
    if (i.weight < w) return k;
    w = i.weight;
    k++;
  }
  return -1;
}

std::ostream &operator <<(std::ostream &os, const scheme &s)
{
  double sum = 0, v;
  os << "triangle quadrature, order " << s.order << ", size " << s.data.size() << ": ";
  sum += v = s.check_unity();
  os << "unity " << v;
  sum += v = s.check_weights();
  os << ", weights " << v;
  sum += v = s.check_poly_auto();
  os << ", exactness " << v;
  int k = s.check_sorted();
  os << ", sorted " << k;
  bool ok = sum < 1e-12 && k==-1;
  if (ok)
    os << ", all OK" << std::endl;
  else
    os << ", BAD" << std::endl;
  return os;
}


#define W(w, a, b, c) {w, a, b, c}
#define N1(w) W(w, 1./3, 1./3, 1./3)
#define W3(w, a, b, c) W(w, a, b, c), W(w, b, c, a), W(w, c, a, b)
#define N2(a, w) W3(w, a, a, 1 - 2 * a)
#define N3(a, b, w) W3(w, a, b, 1 - a - b), W3 (w, b, a, 1 - a - b)


scheme_selector::scheme_selector()
{
  const std::vector<scheme_point> data3 = // 6 nodes, optimal
  {
    N3(0.6590276223740922,0.2319333685530306,0.16666666666666666)
  };

  const std::vector<scheme_point> data5 = // 7 nodes, optimal
  {
    N2(0.1012865073234564,0.1259391805448272),
    N2(0.4701420641051151,0.1323941527885062),
    N1(0.225)
  };

  const std::vector<scheme_point> data7 = // 15 nodes, optimal
  {
    N2(0.06493051315916487,0.0530778017902324),
    N3(0.642577343822696,0.31355918438493147,0.0692746820794169),
    N3(0.517039939069323,0.2845755842491703,0.07085308369213356)
  };

  const std::vector<scheme_point> data9 = // 19 nodes, optimal
  {
    N2(0.04472951339445269,0.025577675658698024),
    N2(0.4896825191987376,0.03133470022713912),
    N3(0.741198598784498,0.22196298916076573,0.04328353937728938),
    N2(0.4370895914929366,0.0778275410047743),
    N2(0.1882035356190327,0.07964773892721025),
    N1(0.0971357962827988)
  };

  const std::vector<scheme_point> data13 = // 37 nodes, optimal
  {
    N2(0.02150968110884316,0.00605233710353918),
    N3(0.722357793124188,0.27251581777342954,0.009590681003543275),
    N3(0.8647077702954429,0.11092204280346335,0.01496540110516566),
    N2(0.48907694645253935,0.02399440192889474),
    N3(0.7485071158999522,0.16359740106785048,0.024179039811593864),
    N3(0.6235459955536756,0.30844176089211783,0.03464127614084836),
    N2(0.42694141425980037,0.05560196753045325),
    N2(0.22137228629183286,0.05827848511919995),
    N1(0.0679600365868316)
  };

  const std::vector<scheme_point> data17 = // 60 nodes, optimal
  {
    N2(0.014755491660753961,0.002773887577637648),
    N3(0.9159193532978168,0.07250547079900249,0.004584348401735866),
    N3(0.824790070165088,0.1591922874727928,0.007978300205929585),
    N3(0.7150722591106424,0.2717918700553549,0.008692214501001196),
    N3(0.5712948679446841,0.41547545929522905,0.01039843995583955),
    N2(0.0666540634795969,0.012459000802305435),
    N3(0.7532351459364581,0.16872251349525946,0.0205578983204545),
    N3(0.6263690303864523,0.3062815917461865,0.022487772546691074),
    N2(0.4655978716188903,0.025019450950497357),
    N3(0.5432755795961597,0.29921894247697034,0.026171625935336996),
    N2(0.18035811626637055,0.026312630588017975),
    N2(0.4171034443615992,0.027310926528102106),
    N2(0.2857065024365867,0.03771623715279527)
  };

  const std::vector<scheme_point> data21 = // 88 nodes, best 87 (+1%)
  {
    N3(0.9778865215640167,0.013234421589438106,0.000797555127469543),
    N3(0.9328159047901035,0.05685625812913919,0.003258236553702429),
    N3(0.8571207822048864,0.1340122214229933,0.004156207926106466),
    N3(0.7529617051534492,0.23764642588419438,0.00552402483200959),
    N2(0.49568588568134114,0.006027450576654855),
    N3(0.6289793890498948,0.3609649565359382,0.00670512540478108),
    N2(0.053053326162124825,0.007077903752383765),
    N3(0.8233176907916,0.13010624040909158,0.009513846042774105),
    N2(0.27733348691070925,0.01137631038161811),
    N2(0.11196507126599037,0.01209875799638412),
    N3(0.7193347650186173,0.23177859807504142,0.012187004098099846),
    N2(0.47729170352729283,0.013146343585755286),
    N3(0.5989690039398154,0.3489415829611428,0.01416002820909603),
    N3(0.6815492908321845,0.20168332989838672,0.016752098091056183),
    N3(0.5656016655026875,0.3118912281361572,0.019879151020475896),
    N2(0.4435626641984419,0.021099029531227175),
    N3(0.45344780282961905,0.34016360667501166,0.02237216001591888),
    N2(0.21301162561612008,0.02301899498498215),
    N1(0.026633003644043134)
  };

  const std::vector<scheme_point> data25 = // 126 nodes, best 120 (+5%)
  {
    N3(0.9825322265320069,0.015301739487044275,0.0005029985649870035),
    N3(0.9337690604322713,0.05938561371573958,0.001959458571124277),
    N2(0.025783327886760243,0.002570638707570668),
    N2(0.053681150630690844,0.0026757543487727787),
    N3(0.8654290668136997,0.12745227207777943,0.0028744879315734106),
    N3(0.7765233137379739,0.21639840915247577,0.0035593067406595306),
    N2(0.3421850782080844,0.003600938823604736),
    N3(0.6709819323646271,0.3218059374483826,0.004109877046298106),
    N3(0.5558252041596445,0.43694620801496,0.004368024269028233),
    N3(0.8774809667754673,0.08748803897824187,0.004831414359876696),
    N3(0.8040169319192616,0.1137391323397286,0.006443588562943415),
    N3(0.7985212768474292,0.16434578159387736,0.00720441300083524),
    N2(0.21409691447092638,0.00740731814874072),
    N2(0.4336174267420383,0.007547493900888675),
    N3(0.7042970394563132,0.25879285776713057,0.008365205031978995),
    N2(0.481459320405971,0.00934787554868949),
    N3(0.5953428256501324,0.3667645166557995,0.0095930895780321),
    N3(0.7268703392453543,0.1820923913537672,0.009658555229154035),
    N3(0.6501380219419006,0.26271634929527315,0.01031565471344358),
    N2(0.4576542189058857,0.01064288580455832),
    N3(0.5528861129084904,0.3543175176109764,0.01297229566724819),
    N2(0.15893470088191064,0.013048381049405805),
    N3(0.5868464151388975,0.25658499407744995,0.01477464653573503),
    N3(0.47650503841902125,0.34996173258169805,0.017424465562585097),
    N2(0.37289400484522706,0.01880981189719399),
    N2(0.26336899997074636,0.019767272372902257)
  };

  const std::vector<scheme_point> data31 = // 190 nodes, best 181 (+5%)
  {
    N2(0.0006105457665706027,0.00004993212922017847),
    N2(0.0381872737739114,0.00019468119313505625),
    N3(0.9451231220784704,0.0531358439968036,0.000540603215862064),
    N3(0.8687371136707015,0.13126288632666727,0.000545571879013004),
    N3(0.9791385846828278,0.016517096009600496,0.0005475842034132076),
    N3(0.7788951923111334,0.21916554859824866,0.0010749383672225235),
    N2(0.09950402006407721,0.0011627518941266905),
    N3(0.4975856062391509,0.49731249078411083,0.001266326585291351),
    N3(0.8589002978537452,0.12281839007932904,0.001333903290328086),
    N3(0.9465085728694591,0.03734924757531749,0.0015698357704773925),
    N3(0.9022452125544891,0.08835949765140971,0.001860689103441904),
    N3(0.6879567874607865,0.30791040437732053,0.001940045887763853),
    N3(0.5940042855325798,0.4011075100068908,0.0023885111062454923),
    N3(0.8198646798772515,0.16776107580713673,0.002855858022482058),
    N3(0.8994370763576088,0.06564898076709402,0.0029823148886291596),
    N3(0.7343982000415574,0.2474764914195261,0.004110987238342821),
    N3(0.8390397636040858,0.11906101792897639,0.004239272782834416),
    N2(0.07696123018334322,0.0045923454217143556),
    N3(0.6359195403870948,0.3402451167137474,0.005188035315449355),
    N3(0.5364732229124937,0.43722502079390063,0.005825839312796845),
    N3(0.7664613425662659,0.1894908947247319,0.00599990170177605),
    N3(0.7758079187117254,0.13883116007159202,0.006540115207543285),
    N1(0.00715796023986029),
    N3(0.6737971258783857,0.27384043996644647,0.00730638829229389),
    N3(0.5377101443958711,0.24854454442890095,0.00765009218529433),
    N3(0.5706432336240768,0.36837961601696767,0.008540955977635005),
    N3(0.6970099343032772,0.20992877839304047,0.008640194619431215),
    N2(0.4680134659074852,0.00904403465843141),
    N2(0.14669308261115588,0.009110015749136904),
    N3(0.6023808183553632,0.29477250578504255,0.00997684019050638),
    N3(0.44999185388976715,0.3388119752179539,0.01028922835193735),
    N3(0.528959461814,0.30990895224480997,0.010593593155471105),
    N3(0.6231354483544869,0.22087341321153597,0.010864170084132525),
    N2(0.4158907959612745,0.010978741581316415),
    N3(0.4956594121606249,0.3914934329232318,0.011233841241705135),
    N2(0.27749337620940046,0.01196134306470252),
    N2(0.3655710632720009,0.01204222494029008)  
  };

  const std::vector<scheme_point> data37 = // 264 nodes, best 252 (+5%)
  {
    N2(0.004004991879127728,0.00021071557453403874),
    N3(0.9774682885885174,0.021004106723641613,0.00021195313273902994),
    N3(0.9689948183171436,0.020914627067955327,0.000539482724715486),
    N3(0.527723904295358,0.4702814517516831,0.00059428025513597),
    N3(0.9030646910169262,0.09428909543949193,0.0006967112582615075),
    N3(0.5767618646025271,0.4203359292847356,0.0007072610455738195),
    N3(0.9451680192727243,0.050972440628322846,0.0007174647328976435),
    N3(0.6563450415161369,0.3422079093522046,0.0007726448865508725),
    N3(0.7904821016251624,0.20710021460518058,0.000808494263099729),
    N3(0.8488909436427178,0.14768797059231709,0.0009659772530439635),
    N3(0.9386843971263363,0.040768722896489695,0.0013456337830722856),
    N3(0.5918797764426174,0.3995954745501247,0.0015266655164734996),
    N3(0.7257695914205967,0.26974002094726524,0.001537611319362685),
    N3(0.849406122375381,0.07530357524742792,0.001590740619929804),
    N3(0.9038906557370266,0.07997529950444038,0.001676820806197919),
    N3(0.8575977834389792,0.12697509968974974,0.001773226049719351),
    N3(0.8996546393479131,0.06020611009674415,0.0018394846849261784),
    N3(0.7900925782118112,0.19500258620440847,0.00240399054274179),
    N3(0.8153565490796525,0.1528550336008152,0.0024678141555473185),
    N2(0.49364650373795665,0.002849037542700598),
    N3(0.858263708575701,0.10058833906910691,0.0029171718185105546),
    N3(0.6546899690733428,0.3305648937753628,0.0029369685925632995),
    N3(0.8026383897971412,0.11607673877017621,0.0030675473042285867),
    N3(0.7949824111002395,0.1443260727349932,0.0031082161416527893),
    N3(0.7220729053688835,0.25565531721176665,0.0031713616341690677),
    N3(0.5556449284505671,0.41973574608248126,0.003722513879826403),
    N3(0.6705691532050727,0.28479761758615996,0.0039849618193514335),
    N3(0.6117853154583102,0.3499363632134712,0.004136938857410959),
    N3(0.7511882065692816,0.20360459338841452,0.004261752833179377),
    N3(0.6853972790175946,0.2426454739990872,0.004753468848126503),
    N2(0.4791409487399024,0.00521795873499904),
    N2(0.12493862702168435,0.00551788837333904),
    N3(0.7313148250534613,0.17892560933381796,0.00557524082268836),
    N3(0.5396063119106593,0.39902320918313483,0.00605159713150222),
    N3(0.6789365059967043,0.18181118595516021,0.006099625044345435),
    N3(0.6427968792253913,0.24412485186806132,0.00634499917763116),
    N3(0.5312760481021273,0.2772779648993804,0.00650908942135261),
    N3(0.37860977588699346,0.3349570132159506,0.00657565168435296),
    N3(0.6023155115148969,0.31762031558325843,0.00685797835826581),
    N2(0.23928211233235225,0.00704067338685),
    N2(0.45716878528335686,0.00714216248362252),
    N3(0.5675179318911977,0.29724469196731196,0.007440928353891395),
    N3(0.6035925487739905,0.2223780883768044,0.007459308349319355),
    N3(0.5159428638186909,0.37337052526492004,0.00784306793576193),
    N2(0.4292701728639222,0.00864252153123303),
    N3(0.47845427862561385,0.34861675049692653,0.00883049641270328),
    N3(0.4485546186103736,0.3080659395479348,0.009490184207271095),
    N2(0.39368199172779417,0.010081724389868185)
  };

  const std::vector<scheme_point> data43 = // 360 nodes, best 339 (+6%)
  {
    N2(0.0028568655616181826,0.0001067145364841283),
    N3(0.9342287054295981,0.06577129457007902,0.00014699875183493704),
    N3(0.9826483287057078,0.01481878357606048,0.00021548782894213365),
    N3(0.8514495564547392,0.14854990250526678,0.0002236297388411686),
    N3(0.9722750125049253,0.015442092547754527,0.0002692499521325578),
    N3(0.9610969797269128,0.035877474069774706,0.0003940047718485004),
    N3(0.5842866026039195,0.4151504124337634,0.0004058303717756547),
    N2(0.4996153929876537,0.0004354225287141336),
    N3(0.7354853002291473,0.2630529298326562,0.0005594639235346756),
    N3(0.6622732438751591,0.33619620020470053,0.000586792859890444),
    N3(0.8935863411605063,0.103106444557305,0.00070269131383628),
    N3(0.927071962318919,0.0650153962666638,0.00088512873307637),
    N3(0.9492100574217743,0.034885406702321986,0.000904217021169793),
    N3(0.7955362045137571,0.20133330065521876,0.000907143120492031),
    N3(0.688316178146694,0.3035501795946109,0.0013156683506990445),
    N2(0.03798604788291199,0.0013201937040107454),
    N3(0.8431844642051403,0.14853134038492466,0.001354266383883608),
    N3(0.9095817152147309,0.06522089077500437,0.0014342451622475815),
    N3(0.7427681268667372,0.2462704269423278,0.001503329071253249),
    N3(0.8821021072202,0.06747556790241982,0.0015399916417600805),
    N3(0.879961965020492,0.10307852269398932,0.0015623921774896746),
    N3(0.5371111916413407,0.45600881683801014,0.0016089205363088684),
    N3(0.6115674333609209,0.3807653602139515,0.001632697116028416),
    N3(0.7889039365906257,0.19368576569212703,0.001922733899126431),
    N3(0.5161312930953479,0.46318848902989385,0.002000455209933446),
    N3(0.8604067226819454,0.09892438410600346,0.0020350098263281213),
    N3(0.8201340594035719,0.11812876800092698,0.0023753914644125684),
    N3(0.8274199822411011,0.14391558428795737,0.0023959237152515263),
    N3(0.6527457691693554,0.3262710240492229,0.002512416752020697),
    N3(0.7596938448745886,0.20243229415067754,0.0026559936285595965),
    N3(0.5605508642851922,0.3894718795570671,0.002672115819669622),
    N3(0.4242945622593955,0.4206187580305772,0.0026897387752541674),
    N3(0.7129501369721543,0.25950176736817954,0.0026903661966770965),
    N3(0.5786023817281546,0.39853614585301833,0.0027273970892557134),
    N3(0.7851594526952651,0.15999404465957034,0.002881534687288657),
    N3(0.6123412962840777,0.34556460179065474,0.0028907071831400077),
    N2(0.08262116457360047,0.0030237106171092936),
    N3(0.6639991096614317,0.28894498754075276,0.003041349097051227),
    N3(0.6399833983715577,0.28471054383416916,0.0031532929911511484),
    N3(0.3985891101244434,0.39785517134197823,0.0032666962517039675),
    N3(0.5121266529085284,0.4453279996687799,0.003338599965418282),
    N3(0.37223520468046534,0.31495410735031354,0.003361119890178636),
    N3(0.710084137262575,0.23049035004230367,0.003522064823057229),
    N3(0.7767938347660309,0.12799672950567575,0.003713973654072113),
    N3(0.6689159456413469,0.23678762328503278,0.003842887259169497),
    N3(0.7173921154989424,0.15706566052801207,0.003935820671389385),
    N3(0.7348631620612803,0.1817617291717082,0.004063888803853173),
    N3(0.5884570816584775,0.3352856160580556,0.004112000231910959),
    N3(0.5244799368772828,0.39791531936726393,0.004150103956657511),
    N3(0.6708147270418185,0.20379315035109458,0.004197529691941053),
    N2(0.4642352740486045,0.0045020741095128745),
    N3(0.5760806698734506,0.22851602312357178,0.004503805478927352),
    N3(0.6095596162806092,0.23816126956774464,0.004981688185468424),
    N3(0.6019557961173596,0.28250675135211084,0.00507831195570555),
    N3(0.4752408227308877,0.4136501323149235,0.005101393358479795),
    N2(0.26789625713027887,0.005127243052860145),
    N3(0.5405644837954902,0.34501109502517496,0.00536665408824313),
    N3(0.4817219765919118,0.36396597811634784,0.00559309266274075),
    N3(0.42419421762365617,0.3191969676493518,0.00561666838214041),
    N2(0.17564381736356893,0.005878225880533375),
    N2(0.3713195342047742,0.005914952813803955),
    N3(0.5140902595792582,0.26980890500339555,0.00620152106852993),
    N3(0.5405542803848498,0.2975673969524558,0.006289929219154325),
    N3(0.4615461319865619,0.334599998662814,0.006478073284245785)  
  };

  const std::vector<scheme_point> data49 = // 475 nodes, best 435 (+9%)
  {
    N3(0.9951096661186382,0.004117511737410595,0.000039798620143093094),
    N3(0.9801056131327773,0.019146189769938093,0.0000820997664092486),
    N3(0.9397286395657132,0.06004532309642374,0.0001074358765338809),
    N3(0.764832296222061,0.23516770377793905,0.00017255103077083646),
    N3(0.9844514513596633,0.011049576481758971,0.0001734023557260448),
    N3(0.5694171008014626,0.430550354533364,0.0002252025985230872),
    N3(0.6979334809832927,0.30170195587635074,0.00023506741680795446),
    N3(0.9037691351664556,0.09479785319028167,0.00028202996508512227),
    N3(0.9609009523897548,0.03618996433293398,0.00031039763623402897),
    N3(0.6342697849882775,0.36471539460714014,0.0003460932660773902),
    N3(0.4991012703439654,0.4988025848293319,0.0003482068378121889),
    N3(0.8222129248244834,0.17609001521632783,0.000409673960438355),
    N3(0.9670830068401608,0.022222060480555084,0.0004493048696678966),
    N3(0.9308972879979835,0.0633767101839936,0.0005072649779582395),
    N3(0.8643523080604851,0.13315988042478,0.000515204810939501),
    N3(0.9000019580027119,0.09178076693114667,0.000596418007934415),
    N3(0.8717347873248396,0.10580830545473918,0.000724197580472128),
    N3(0.7837281481972177,0.2113681673013097,0.0007272270750411245),
    N3(0.9412487064131242,0.04456290978093569,0.0007293970269276955),
    N2(0.02752404832755795,0.000787896043134627),
    N3(0.86609858380757,0.12188941599765968,0.00089638616090385),
    N3(0.7305765185873425,0.2644971068041806,0.0009325689096403075),
    N3(0.6710500914978501,0.32300872971449823,0.001038949689066873),
    N3(0.6073691417884248,0.3864216107721907,0.001047779240327586),
    N3(0.9059152104543802,0.0738830295093259,0.0010896448463253556),
    N3(0.9156494440225017,0.05120781295831944,0.0011048356229650495),
    N3(0.5511396951860712,0.44297068062726563,0.0011075624917642466),
    N3(0.8240096699693833,0.16464953050371645,0.0012737262243832374),
    N3(0.5457064360230119,0.3649235197590822,0.00130566330407775),
    N3(0.7657314912960633,0.21920900328520365,0.001396444625813899),
    N3(0.8675525780681136,0.09560892060520576,0.0014114010724562195),
    N3(0.8819600228212416,0.06907055075939139,0.00145667343892452),
    N3(0.48381151751643725,0.4828873513756802,0.001466883411855893),
    N3(0.6520948702227929,0.3304284877285272,0.001609439970877422),
    N2(0.4934737410257833,0.001658642741236774),
    N3(0.7094206700237953,0.2737629443192041,0.0016717377221377805),
    N3(0.5989692706384693,0.3824763455165981,0.001687044107208435),
    N3(0.8319585952493675,0.13922092189482804,0.0017313819594583196),
    N3(0.523328646149632,0.3924032937609692,0.0017740121423405314),
    N3(0.8419916215318005,0.08906756859711995,0.001779797918495919),
    N3(0.788002102164922,0.18462513691835403,0.0018227192904365745),
    N3(0.5441680603825044,0.43603027681886297,0.001895070386966041),
    N3(0.701557655224788,0.22617852416139028,0.0020236928076066613),
    N3(0.7900147124624473,0.15965804472033052,0.0020393592666954315),
    N3(0.82574444035039,0.12024484124644774,0.0020666958948026633),
    N3(0.7283604020843188,0.23900673487890245,0.002195091931514973),
    N3(0.7280225071232722,0.1931382044886657,0.002211692495494619),
    N3(0.6175228634399025,0.19127239088653913,0.0022414511635718334),
    N3(0.7452379895006174,0.1370330888140513,0.002285405195018476),
    N3(0.7484344343441072,0.20205990933029144,0.002286004981378558),
    N3(0.5568409466721591,0.2215962373330439,0.0023565184674331965),
    N3(0.666227950049672,0.29901653044758314,0.002468797990418409),
    N3(0.7684287144322254,0.15326498020217738,0.0025301094051286303),
    N3(0.7956194116264935,0.11565038933960514,0.002554636242868446),
    N3(0.718809937560189,0.1716200138373163,0.0026721364670466864),
    N3(0.6849262657043085,0.26048609384033816,0.0026758622156023773),
    N3(0.6060606423767996,0.3564272806388735,0.0026887426425642414),
    N3(0.5456009439415281,0.41515032798675183,0.002693293628684685),
    N3(0.39128512668743876,0.3760936584202177,0.002899629001022771),
    N3(0.41414218408234177,0.40701735807669925,0.002900450659277406),
    N3(0.5635010209331509,0.37290090276718946,0.003225610068547304),
    N3(0.6827820156332224,0.1721001494262493,0.003270776385236571),
    N3(0.4988301999159191,0.44128535224106175,0.003342000859446222),
    N3(0.623416115917439,0.314495834898963,0.0034545742198268834),
    N3(0.4787271952185459,0.4287422326402234,0.0034770999934283955),
    N3(0.646134132525285,0.26636581457240266,0.0035804405100540297),
    N3(0.6731081093424717,0.2176647835896227,0.0036489115835934803),
    N3(0.45719247196760254,0.4118540699735575,0.0038850028271570193),
    N3(0.6345180887849746,0.21614165571711408,0.0038925574140353373),
    N3(0.5156095655512531,0.3661815442038044,0.00399337486136009),
    N3(0.5835721382066001,0.31959501818148084,0.004123715809127031),
    N3(0.606783554510687,0.2669060284284758,0.004305190448187429),
    N3(0.5102165042929425,0.30342841609706594,0.00458519311235651),
    N3(0.5459060439590311,0.312582927797759,0.004654525399046447),
    N3(0.5026416126448316,0.2703843684460798,0.004756205481416391),
    N3(0.4459465425835839,0.297777839020068,0.004819997957275055),
    N3(0.47606736092180435,0.3611261566441216,0.004888310695168346),
    N3(0.5710935335417116,0.25389151686484546,0.005090513406671175),
    N3(0.44512612195696194,0.3421156239353758,0.005417576755969055),
    N3(0.38862540864544737,0.331253378955085,0.005764970349227975),
    N1(0.00597949479175266)
  };

  const std::vector<scheme_point> data57 = // 628 nodes, bound 571 (+10%)
  {
    N3(0.6697457780873556,0.26731684176683557,0.00003157624311150262),
    N2(0.0016434314301472797,0.00003550934460608033),
    N3(0.9897567101121734,0.0086238870549874,0.0000807800892260897),
    N2(0.47668271494109526,0.0001003322484501139),
    N3(0.9386146036654686,0.06066936518525845,0.00010659330284387356),
    N3(0.9774035786564743,0.02102795511821476,0.00012121762913044165),
    N3(0.6525960750594579,0.3468212059998,0.0001616821366838974),
    N3(0.95976707483558,0.03855250261381893,0.0001711063913185345),
    N2(0.00850491193349856,0.00018452652462442134),
    N2(0.4117803778549517,0.00019803686499256725),
    N3(0.49928458074663734,0.4992511101351998,0.00020798126815746936),
    N3(0.9111822816053279,0.08720313038167249,0.0002356387666025499),
    N3(0.6805173726172966,0.3176334031744723,0.0002552682348883957),
    N3(0.880634120511953,0.11782661046783027,0.0002599966948468053),
    N3(0.9708794957439104,0.02080066966522187,0.00028421197681066293),
    N3(0.7640004482557298,0.2346837854570507,0.0003042647750265196),
    N3(0.8452798550033906,0.1530961460425273,0.0003113605628822468),
    N3(0.8064828581391627,0.19199582227869127,0.00031442570509869965),
    N3(0.5541830918604977,0.4445996814965276,0.0003380525480088925),
    N3(0.718141421685338,0.2803404768300305,0.0003495901692170953),
    N3(0.9333540273519567,0.06111078882976578,0.00038185878352941594),
    N3(0.9529562467973125,0.038404288100904904,0.0003850795150194416),
    N2(0.020591690406433716,0.0004527588973511915),
    N3(0.6057364243364698,0.39246213509612254,0.0004638866727351984),
    N3(0.9412374130819091,0.038411476168664915,0.0005644481792434505),
    N3(0.9019767174119518,0.089594731660528,0.0005860077548472685),
    N2(0.036172900271349784,0.000643026287473502),
    N3(0.8691040458529145,0.12280825573404974,0.000647549165777335),
    N3(0.9226329594008369,0.06158667081400293,0.0006608563933090765),
    N3(0.7911815176244306,0.2014001013379927,0.0006788629369266965),
    N3(0.7470895204233821,0.24578045394996567,0.0007627171931938065),
    N3(0.6485332000341453,0.34542469660193187,0.000763006352283723),
    N3(0.5470531649580352,0.4464329423426859,0.000777498584898182),
    N3(0.8308255227970642,0.16052816560105787,0.0007831823615761345),
    N2(0.04979839111437456,0.0007861576697753155),
    N3(0.7760995216487346,0.20739800287553967,0.0008225697644837155),
    N3(0.9102464621489263,0.058527432202416185,0.000828179447549093),
    N3(0.8911789062648611,0.08825038225768422,0.000831802749079984),
    N3(0.8620918238081491,0.11829765815798798,0.0008529754765408715),
    N3(0.8319170737988049,0.147102612991043,0.0008589340675193535),
    N3(0.8823261210115024,0.0815058641116223,0.000910935696300072),
    N2(0.4960011556755976,0.0009208267590650905),
    N3(0.6979559969920555,0.2935289089993026,0.0009310885014096225),
    N3(0.8023299224851108,0.17653200028692972,0.000931928793469033),
    N3(0.8749544600086643,0.0706508526191475,0.0009532022410497225),
    N3(0.8502896659552112,0.09568201738251059,0.000966255634606943),
    N3(0.5950560246381822,0.39574716096259355,0.00103550713885605),
    N3(0.7532946276810932,0.2181678445986887,0.0010359818988498516),
    N3(0.6272482565459359,0.2840213434637638,0.00109081380181334),
    N3(0.8397659524005379,0.08739385844957026,0.0011113183226127655),
    N3(0.6802888717354294,0.3000693114738363,0.001149407623415903),
    N3(0.6293135826051299,0.3402589442361649,0.0011688666106378484),
    N3(0.6399075635409135,0.3441415045669327,0.001172061224388852),
    N3(0.730935131789409,0.2509536136673889,0.0012208975312078855),
    N3(0.8516408616150681,0.11196641528163809,0.00122855011791509),
    N3(0.6432061047169889,0.31941971296282456,0.0012525004204020284),
    N3(0.5413416258403481,0.44161865275449236,0.0013274545154895955),
    N3(0.6931470477735826,0.27551339874318403,0.001383033861992022),
    N2(0.49018123881545544,0.001398570283625477),
    N3(0.8156528003855871,0.1457669051513366,0.00147952551896928),
    N2(0.45930102052892846,0.001540842175014935),
    N3(0.7773309709973465,0.1845698068659728,0.0015642282034592865),
    N3(0.5889350601683511,0.3885859935002831,0.00157710512756708),
    N3(0.44931975644384636,0.3836770709668931,0.001580752738193068),
    N3(0.7227926750288662,0.23681852169643425,0.001599590060542042),
    N3(0.8163459470746863,0.12317387169926652,0.0016994243947405225),
    N3(0.4574485433649775,0.27745807268351974,0.0017984079432521705),
    N3(0.8016710460176208,0.11070027392579773,0.001836758221812704),
    N3(0.6676288136399458,0.2825633493263239,0.0018566286230394195),
    N3(0.535389473504316,0.4317296562073631,0.00186557024970666),
    N3(0.695135861240677,0.24251183082307293,0.001914849662054004),
    N2(0.4820887686154414,0.001928123494567338),
    N3(0.779126289835279,0.15993712708573316,0.001938510805726967),
    N3(0.7405986239870859,0.20187536388577798,0.0019742645331622204),
    N3(0.6435740827078267,0.28261281318417225,0.002110691594980083),
    N3(0.767431881741386,0.14448381950800682,0.0021779326900948563),
    N3(0.5807465560720053,0.37723785259468856,0.0022244724540758983),
    N3(0.6171945155138653,0.22221577115373503,0.0022251212196579577),
    N3(0.6866059948482623,0.22799671702603674,0.0022269428127854284),
    N3(0.6444379722945166,0.25242789575012037,0.0022315187398174573),
    N2(0.471109058170454,0.00226575483001702),
    N3(0.5225127037506139,0.42401790100951225,0.0022929992633194565),
    N3(0.7292538820590377,0.18637653287821776,0.0024360460712338763),
    N2(0.14850124949720755,0.002455345879936075),
    N3(0.6121858779797937,0.32952480584627053,0.0024982407157097034),
    N3(0.7229112952940615,0.1615148177965018,0.00254812239285284),
    N2(0.12093637635060206,0.002593068105883989),
    N3(0.55662064400069,0.3757877479342807,0.0026231395369779044),
    N2(0.4467380890531005,0.002704149259417501),
    N3(0.49899474491751467,0.4201379487762184,0.0027161479571724597),
    N3(0.4324687428145765,0.38194536916141264,0.002735380292041117),
    N3(0.6289786369070827,0.23857465003129885,0.002759883127938758),
    N3(0.530497440738488,0.3720479254872585,0.0027924097562629373),
    N3(0.6817571590423704,0.20261260695153416,0.002850641963788674),
    N3(0.575961374363961,0.24105849844280813,0.0028643234585204796),
    N2(0.39325352473762754,0.0029280778651081516),
    N3(0.584505653463958,0.3276646940993795,0.002938585055059167),
    N3(0.5929875338079741,0.2909042292866406,0.0029857120319663963),
    N1(0.0030018043047550123),
    N3(0.6627021984532064,0.18617809479652336,0.003021564929602496),
    N3(0.4829746302291853,0.3996715477149652,0.0030723745067833814),
    N3(0.37344754253469203,0.3314261700071573,0.003127416800681007),
    N2(0.21879186295413577,0.0031919675025863874),
    N2(0.1913214175750227,0.003217594531706571),
    N3(0.5735553751738213,0.27558842902425973,0.003339362078513935),
    N3(0.5244942214260162,0.3139717558997499,0.003339856796113078),
    N3(0.4869829207730034,0.3662146618674623,0.003344366486734055),
    N3(0.5413473307145897,0.3345301314533984,0.0033801098532164407),
    N3(0.4755866807046923,0.29512596249638257,0.003653150404519354),
    N3(0.41613834317833887,0.31384082159225624,0.003719844289346892),
    N3(0.477368993956671,0.3319531194490104,0.003745024184623826),
    N2(0.42791400052241385,0.0038069324122565),
    N3(0.526879866822093,0.27535752686590764,0.0038702059631517166),
    N3(0.42837019120609243,0.3438826489188801,0.00391244500770448),
    N2(0.24345393067217036,0.003953472647441776),
    N2(0.37234469498406,0.004022429626005763)
  };

  const std::vector<scheme_point> data65 = // 814 nodes, bound 737 (+10%)
  {
    N3(0.5963012293051821,0.2943989451214501,3.4671593958287406e-6),
    N3(0.9928086572656301,0.0071839725999101045,0.000014082265022945325),
    N2(0.0013903898290667516,0.000025337543425750564),
    N3(0.6554804065056435,0.3332716547622001,0.00003005637966485228),
    N3(0.8942913630097398,0.10569609518003786,0.00005700759215182145),
    N3(0.8618792164846094,0.13788237953022453,0.00006766338415098445),
    N3(0.9896904668767881,0.007332476280841882,0.0000748469457801921),
    N3(0.9809738013821101,0.017683485141778088,0.00008796108542442556),
    N3(0.6146632560225751,0.38513420736514037,0.00009887695399905905),
    N3(0.9659508115465282,0.03296595758979415,0.00009918832722222505),
    N3(0.9461716346031247,0.052650927765476085,0.00012904393342519596),
    N3(0.9228933178721468,0.07608979771462832,0.0001332182023156482),
    N3(0.5692371005148447,0.4301417069025616,0.0001615354335797342),
    N3(0.9786572201939036,0.013964647237587391,0.00016626715581854066),
    N3(0.9668676031251209,0.027014943872443742,0.00021403231599264976),
    N3(0.7571407184104835,0.24188993146453663,0.0002141377719016597),
    N3(0.5213796764915776,0.47767458959862574,0.00021509836135090064),
    N3(0.7983635703126156,0.20046577836250457,0.000229029599162314),
    N3(0.7131525545021866,0.2858286105409764,0.00023214122197322935),
    N3(0.963599004619601,0.02131530433857942,0.00023263052058739044),
    N3(0.6689229088463844,0.33004222120271953,0.00023423230639165105),
    N3(0.8328849135833777,0.16565528960733678,0.0002358957383751324),
    N3(0.9498802595206363,0.04424493312882516,0.0002617989091929763),
    N3(0.941900165638549,0.02932990021688142,0.00026910612118753377),
    N3(0.8992318356997878,0.09740974626929733,0.00029461522319683604),
    N3(0.6334231413691302,0.36411583149902826,0.0003168636535025884),
    N3(0.8701271643242021,0.12670912193536998,0.0003236715539195929),
    N3(0.9264479959534455,0.06781199792077408,0.0003312239101820863),
    N3(0.5078035529204143,0.48679386237586797,0.00034643334302949874),
    N3(0.5470141768693931,0.44922683934315033,0.0003756791833070904),
    N3(0.9494944780186877,0.03534028590575433,0.0003789414418340097),
    N3(0.9322264588498647,0.05460171363285227,0.00038109725433864677),
    N3(0.771801673231668,0.2232853048057849,0.00038755283460541564),
    N3(0.8402106628083723,0.153403430876778,0.00042431302680879374),
    N3(0.9013378311274705,0.08844014798995392,0.0004342899997064287),
    N3(0.844963274620863,0.14202734703817332,0.0004392913277401267),
    N3(0.9152084136898976,0.04657157790591537,0.0004514972201600902),
    N3(0.4938581068580478,0.4927556331205741,0.0004638301310495626),
    N3(0.9101164072524572,0.0724627509846405,0.0004920287789340814),
    N3(0.7582883686013173,0.23130680621001076,0.0005083906480212995),
    N3(0.7294121068465599,0.2654103095488751,0.000513866653198591),
    N3(0.5913592758860835,0.4045619649629112,0.0005269297542853285),
    N3(0.9262333678562623,0.048658779802128294,0.0005427744742600545),
    N3(0.873309053384198,0.11596187731768326,0.000566609508708557),
    N3(0.8052203415705549,0.18764004728520045,0.000591201492486122),
    N3(0.6834533382424695,0.3109141932258382,0.0006154933370760665),
    N3(0.5030176271483752,0.4719275939120725,0.0006775253361902776),
    N3(0.740863917990871,0.24123096489463736,0.000678981625515255),
    N3(0.8999453142597571,0.07009043268295534,0.000688688221376154),
    N3(0.6358546991377915,0.2607979327815402,0.0007104901262890205),
    N3(0.6371483171914607,0.3546601116073962,0.00073025649484239),
    N3(0.8796636445837971,0.09850741199200319,0.000778777654107174),
    N3(0.8161604765790552,0.1667718335783569,0.0007793158565204785),
    N3(0.8721581836973048,0.09118117205069243,0.0007800269596740185),
    N3(0.7117019722878292,0.2753552818835875,0.000787971790670427),
    N3(0.5443993277869745,0.44536858018377756,0.000811784725294856),
    N3(0.5305636815854606,0.44930810416820466,0.000840776559068065),
    N3(0.792805079762211,0.1503524782366379,0.000841089085053681),
    N3(0.8901415480940391,0.06324030308638928,0.000850277814401089),
    N3(0.7816177780622641,0.20149727412597507,0.000850916636851872),
    N3(0.847978852948913,0.12861554811103493,0.000867054529309862),
    N3(0.8126173758022346,0.14275608542192275,0.000905634017045375),
    N3(0.6705854490122011,0.31420413398846464,0.000913614613292927),
    N3(0.4741896211283092,0.47292239323830565,0.0009350076048964256),
    N3(0.5901121835591704,0.39770963105738755,0.000939253060389659),
    N3(0.5920614629685639,0.3800336029146635,0.0009559241914172105),
    N3(0.859577057280978,0.08718932678598645,0.000970591190510134),
    N2(0.06793451021473984,0.000977763083772748),
    N3(0.5641499521135598,0.41297152752527677,0.0009884222268099255),
    N3(0.844348863900753,0.11716426189544538,0.0010085928897613215),
    N3(0.8120390888513958,0.1572341353047524,0.0010303120726895675),
    N3(0.6254203866979289,0.35538796385818316,0.001074722629324637),
    N3(0.741296236993626,0.22967304256016174,0.001100735420594406),
    N3(0.8323653021496471,0.09218035336219521,0.001101374408237949),
    N3(0.7773905537732011,0.19186964697425446,0.0011338928336715735),
    N3(0.6585617283748001,0.31326942079888687,0.001154256998604347),
    N3(0.6010495712462026,0.32571998362142507,0.001181142750142345),
    N3(0.5037968915343165,0.4593928749249556,0.001185657520527277),
    N3(0.7000659365371658,0.27385591499080175,0.001201163368900475),
    N3(0.4333484842875792,0.2833512509016042,0.001278382064674836),
    N3(0.8268293392736386,0.11404310806773554,0.0012916900686765565),
    N3(0.6202143735451608,0.34362127379065166,0.001298370854947716),
    N3(0.7901159129683788,0.1368109042992791,0.001321400233260452),
    N3(0.5406246659225711,0.4222594423527821,0.0013300228528738385),
    N3(0.7360977488746991,0.2181494804536892,0.0013570757852083126),
    N3(0.7719187998084169,0.17963133240704365,0.001410599215774028),
    N3(0.7001587176665229,0.2577682591332353,0.0014108251002384726),
    N3(0.7287450677702763,0.20683855791591155,0.0014255004015872885),
    N3(0.5743052905119217,0.38186345720107123,0.0014919000903980664),
    N3(0.7987560439669178,0.11188142988514715,0.001542603727512501),
    N3(0.6591435133990917,0.2962405688736681,0.001550251290480199),
    N3(0.5725964719351135,0.345349740578774,0.0016164850099668845),
    N3(0.7017660593392623,0.214046105500186,0.0017201274548824205),
    N3(0.638602412674616,0.23356056129261005,0.0017274132387002895),
    N3(0.7542070042519359,0.1726511686115766,0.00173349097954997),
    N3(0.6113641682704555,0.33425593709993306,0.0017490516120503155),
    N3(0.647483896779372,0.28759249709195167,0.001790957879769865),
    N3(0.5612770508589753,0.3761370166418923,0.001808451213047694),
    N3(0.7577938106171229,0.14536171329750514,0.001808854526183323),
    N3(0.6896099262215919,0.2477297575399673,0.0018177667454018704),
    N3(0.61903407296028,0.29397673765658294,0.0018324846459135216),
    N2(0.1181851654852768,0.001859216989666749),
    N3(0.48775958829419397,0.41169290575750106,0.001942092637440321),
    N3(0.6722539232817328,0.21790927233573287,0.001960822001013375),
    N3(0.6608618190213147,0.2518843819151616,0.0019608650556658053),
    N3(0.5194937249148904,0.4241663028764404,0.0019655063637570606),
    N3(0.6145588932764023,0.2689749261379334,0.001973872699428274),
    N3(0.7203778525771509,0.1805466266697482,0.0020033508199500233),
    N3(0.4825725080842567,0.44168627979361,0.0020216269514785933),
    N3(0.5011539760371714,0.2608109917736964,0.002043303732821797),
    N3(0.5242717715474314,0.3948741675880378,0.0020629202635396556),
    N3(0.7224187230573906,0.15129720537207736,0.0020736831632904144),
    N3(0.5404023526233286,0.3584273258699954,0.002089649090333399),
    N3(0.6859829320086964,0.1852933131416391,0.0021203873676449666),
    N2(0.2201765941675472,0.002131004707690157),
    N3(0.5012900656630535,0.3789524591493981,0.0021503484230126434),
    N2(0.44847481225884767,0.0022580864758384267),
    N3(0.5800169213565558,0.31249858490594007,0.002350985713347322),
    N3(0.53604823811297,0.2530296843211165,0.0023995526713517365),
    N2(0.18527874963855046,0.002402589063826202),
    N3(0.6031015189339796,0.2442443059129299,0.002428680432011683),
    N3(0.6439152450220805,0.20340513008676442,0.00244189159278259),
    N3(0.5368181972258043,0.3320917533038842,0.0025731490615448047),
    N2(0.16075999332491153,0.00258967942826138),
    N3(0.4548267513928376,0.41267820606900735,0.002663595922747799),
    N3(0.5731144029802604,0.286596127900103,0.002676542379251432),
    N3(0.5918894248530177,0.2225698255378178,0.002770445498902624),
    N3(0.4877070409826673,0.36171723095597236,0.0027773331272522486),
    N3(0.4638484167982036,0.28893040886291094,0.002838680287648022),
    N3(0.5547832685110229,0.2681617520056059,0.0028564556558603824),
    N3(0.39814594269967307,0.362052380979467,0.0028608093520623573),
    N3(0.438149599092053,0.3961162470630225,0.0029139207217448223),
    N3(0.5220207269227675,0.31268284592379625,0.002959843170598663),
    N3(0.46985084775043606,0.34445923941503487,0.0030665767465771596),
    N3(0.4199535138397995,0.3784397773465463,0.003067537279580481),
    N3(0.4092915480030662,0.3227894666755723,0.003142085263960266),
    N3(0.4460605550635128,0.32913504612115635,0.003164138952709498),
    N3(0.4991302082073473,0.29693232944767955,0.00322603220181463),
    N2(0.3106813529470486,0.003321147673219532),
    N1(0.0034108049217622064),
    N2(0.3587276090538595,0.0036665069164692277) 
  };
  
  const std::vector<scheme_point> data73 = // 1059 nodes, bound 925 (+14%)
  {
    N3(0.9978226195934061,0.0010890402064628324,7.804529459172235e-6),
    N3(0.9933154122155781,0.005744574056948837,0.00003148281964454436),
    N3(0.9898479343253891,0.005367745117495382,0.00003429916897896946),
    N3(0.6004534302153681,0.39954656886874124,0.0000426836226611346),
    N3(0.6326752746532357,0.3673224164306489,0.000046541327994732307),
    N3(0.9849770041904365,0.014075787595680844,0.000049001407505241),
    N3(0.6911115860729021,0.30887656498886307,0.00005778237191445345),
    N3(0.9731097761677564,0.02590619832667962,0.00006858177886844236),
    N3(0.9760599508641606,0.012636679854761468,0.00007678804346532454),
    N3(0.5395572720408851,0.46033786875328364,0.0000783675766376367),
    N3(0.9578150758729365,0.041192439316715346,0.00008629306284218786),
    N3(0.9824866743791654,0.012605268736558095,0.00010058373591044675),
    N3(0.9391887183857226,0.05979790525907569,0.00010544595173321474),
    N3(0.9172678746571629,0.08177920671525196,0.00011578982180729994),
    N3(0.8919707474060394,0.10719576614161241,0.00011587253335333465),
    N3(0.8637010419697897,0.13544567323770196,0.0001287646172171726),
    N3(0.49949322088690334,0.4992288505992251,0.00012955127273640794),
    N3(0.5454842438926897,0.2768117603206197,0.0001328530442224338),
    N3(0.9713307458903653,0.023482861378579245,0.00014886537269179296),
    N3(0.833205815560905,0.16584543551716036,0.0001533737271466015),
    N3(0.8193717060925974,0.1430813643600256,0.0001538347859632374),
    N3(0.7289460782006139,0.2702154141773258,0.00015851114955148766),
    N3(0.9521460656102152,0.0249234914310974,0.00016666254786123396),
    N3(0.8005038855540163,0.19852626893425362,0.0001683705338861655),
    N3(0.7656126210096899,0.23347011483720626,0.0001690829549978701),
    N3(0.9570853734469098,0.03773883070892725,0.00018412435013595),
    N3(0.6583780767126156,0.3402687334211869,0.0002132245439871061),
    N3(0.9648938039054483,0.02227300131184884,0.0002205416633917799),
    N3(0.9395926404637889,0.05506729107939656,0.0002295463215540854),
    N3(0.5752878832529762,0.4232462199135762,0.0002490582833685131),
    N3(0.9190994281788221,0.07577074873499945,0.00026003315289051027),
    N3(0.9257315765254562,0.03899384671570072,0.00026110084350660176),
    N3(0.7411300125665423,0.17088095810812498,0.0002615210386072355),
    N3(0.8955288953444158,0.09992676320568006,0.0002641976323208609),
    N3(0.9516504201923802,0.03578617475845092,0.0002730010756219461),
    N3(0.8690153356216618,0.12655871516392936,0.0002819471074233264),
    N3(0.49731880093754216,0.4958155254185263,0.000306828905289534),
    N3(0.839624145269406,0.15552364270427027,0.00033372299780505847),
    N3(0.934324065643606,0.05258652028643829,0.0003474320605633494),
    N3(0.6954530610359836,0.30165964650062893,0.00035472891927866134),
    N3(0.7363595968347707,0.25926260029671366,0.0003648980356497807),
    N3(0.6163519708609739,0.38094695452121125,0.0003703947953286037),
    N3(0.9386594947149156,0.03815449764666945,0.00037671188380153565),
    N3(0.6536955097224781,0.3410144382271159,0.00038412217194507957),
    N3(0.8075084336086662,0.18737847434678068,0.0003846404817477306),
    N3(0.8857422628244457,0.05888257634696703,0.000388006075271644),
    N3(0.9148353311270897,0.07247417893404429,0.0003910314231340676),
    N3(0.7731122135827756,0.22196119074630793,0.00039819960050815846),
    N3(0.8930772515103645,0.0955781783737204,0.00040267761370567893),
    N3(0.5368013061927679,0.4598293641347073,0.0004149127539202044),
    N3(0.5682223340075855,0.3032823912625736,0.0004272566072982059),
    N3(0.6476265072917743,0.338761369283592,0.00043535453435793626),
    N3(0.6590962620354338,0.30124044653255333,0.00043932515506284945),
    N3(0.6727585767499342,0.31786401840178746,0.0004393356315909969),
    N3(0.8675387843324882,0.12144928248571463,0.000441803285649691),
    N3(0.7414992305446115,0.2480510712476467,0.0004729685017724902),
    N3(0.8390973269682767,0.14921518362699082,0.00048580854608063265),
    N3(0.9200438996225268,0.05563920782082932,0.000490390366912123),
    N3(0.9013277301915738,0.075685319349729,0.0004991545572140235),
    N3(0.7053344699685389,0.28591902177424633,0.000507785389996418),
    N3(0.8814358884275617,0.09773378115776177,0.0005189310267853515),
    N3(0.822549675731088,0.08941630116319177,0.00052054463356934),
    N3(0.7240790495517211,0.13942997856824602,0.000525634287342789),
    N3(0.7193168716382197,0.19730215149257113,0.0005336477521705075),
    N3(0.7340364745681338,0.24880810297355854,0.000544243536835203),
    N3(0.5780356465143052,0.4154529150153989,0.000558508003623722),
    N3(0.8083421106730353,0.17922676455120423,0.0005610454736865975),
    N3(0.5044102312467114,0.47967583369035116,0.000580505057416351),
    N3(0.5639394347914021,0.32359596628044973,0.000609313699538058),
    N3(0.9063017144474365,0.05452195627106038,0.000612052825141474),
    N3(0.8562609236073976,0.12283991264339245,0.0006136849473626465),
    N3(0.7754075290604663,0.21229536611157207,0.000614398558941677),
    N3(0.8888157410810195,0.074893876944505,0.0006434087045246485),
    N3(0.6178590511925366,0.37283643521975834,0.0006484034193426435),
    N3(0.871528515618915,0.07692989656874838,0.000675584772153485),
    N3(0.8272033991094526,0.15110516599555845,0.0006813003255330025),
    N3(0.853463706821499,0.07897883068088157,0.0006826786226333805),
    N3(0.7380288926994945,0.18605813916230207,0.000683760360716024),
    N3(0.8681631151353526,0.09842129607138528,0.000697767006374819),
    N3(0.5380998074931275,0.4515313676914352,0.0007102746809685545),
    N3(0.6614476656158287,0.3188278876315431,0.000723268604632575),
    N3(0.43153951339158525,0.35735152771365164,0.000724173096152789),
    N3(0.8113397016514658,0.15461811304105244,0.000734331293890621),
    N3(0.6981798323268289,0.28431138551385726,0.0007597401752540445),
    N3(0.6947341414789335,0.15294868358923047,0.000772700102388198),
    N3(0.7842362229440916,0.14990618653854815,0.000773668027990487),
    N2(0.4722845178693374,0.00077397083708719),
    N3(0.7942440580503473,0.18281981630581512,0.000788832382142766),
    N3(0.7613979213517845,0.21596123870791883,0.000790175178872766),
    N3(0.8416081287849643,0.12440829533013387,0.000790735102211898),
    N3(0.8517158592180197,0.09941216711874634,0.0008280271821260885),
    N3(0.5785555018708965,0.40616312179396835,0.0008438192719427135),
    N3(0.7222713413579258,0.2505008545736539,0.0008495042438010305),
    N3(0.7604911059889898,0.16692801662951062,0.000879679054873018),
    N3(0.5042432762463265,0.4683674394461198,0.000880878883709227),
    N3(0.7494153279208542,0.21519868035932022,0.000888779156561668),
    N3(0.5393844203878229,0.4396555748480208,0.000916852812389341),
    N3(0.6160443094239272,0.36399926601229654,0.0009276662178441675),
    N3(0.47477385562940855,0.45350254018962655,0.00093119264834807),
    N3(0.766443729565054,0.1231066478941859,0.000931272480985751),
    N3(0.7123165325762448,0.24714007919191538,0.0009336942181821565),
    N3(0.6459073642755084,0.30658790097112054,0.000934512758169226),
    N3(0.6970304916037915,0.20567731876700224,0.0009487081851469315),
    N3(0.6820102706827433,0.2719389060620213,0.0009512673359266665),
    N3(0.7792203761477531,0.1838711757089343,0.0009519173536721585),
    N3(0.7341104652801483,0.2161397968494193,0.000957302151331875),
    N3(0.606696804996695,0.3599059708165495,0.000958839257424029),
    N3(0.7962424700849147,0.15406134392356585,0.0009590770300617215),
    N3(0.500483447346439,0.4456947219437971,0.0009655066577848205),
    N3(0.7254580771490664,0.2080930763295048,0.000977957659141839),
    N3(0.8243632881925937,0.12491788816443117,0.000979697346069749),
    N3(0.642243169368163,0.3271016823846846,0.000998238972230838),
    N3(0.6842644494925763,0.2857717338926252,0.001004308467715003),
    N3(0.830674433448648,0.10136050048486034,0.0010055362515705055),
    N3(0.5749891550490325,0.36526886792553076,0.001018142928630496),
    N3(0.49895181041986225,0.46077523539494747,0.001024889606608025),
    N3(0.5750445706542049,0.3972920601955695,0.001026659534514076),
    N3(0.6425815556379506,0.23257820900816972,0.0010410768135744924),
    N3(0.8029714687249878,0.12648445445929224,0.0010553268603726725),
    N3(0.6687189983607102,0.25252454242708167,0.001089608589258099),
    N3(0.6857711582234753,0.20326006133381191,0.001121832939774158),
    N3(0.48234239933683415,0.36630976732605064,0.0011236363011234835),
    N3(0.6932490785080463,0.22564083311873595,0.001157337894610212),
    N3(0.7621317344439229,0.18393145407438605,0.0011575704395200245),
    N3(0.5386341559874397,0.42596688802356375,0.0011611242028473395),
    N3(0.6626670924591382,0.27479270038079406,0.001171479223911107),
    N3(0.7957561180199403,0.11300331573013134,0.0012105627752384354),
    N3(0.6989276469031633,0.2413556442022703,0.001227421520282213),
    N3(0.5730690366589185,0.38275759773078954,0.001232930255896162),
    N3(0.5454767464020945,0.22726688900906122,0.0012389750365094695),
    N3(0.6124423606993258,0.33931973996041653,0.0012723338081401514),
    N3(0.5948580648693864,0.3366473400138378,0.001272757089296447),
    N3(0.5352794088357431,0.4126671525393278,0.0012856792221182464),
    N3(0.6290884236914218,0.30505053060424947,0.0013327766607749926),
    N3(0.7377181288262391,0.14609126261392036,0.001353904622396063),
    N3(0.453575854748913,0.4304310800847345,0.001354760986263721),
    N3(0.7666894263502754,0.1434078446369148,0.001386364833775612),
    N3(0.7276932756029666,0.1724598337651912,0.0013918416213776486),
    N3(0.5454669412823756,0.3848871162333687,0.0013999520756080644),
    N3(0.5759785597473229,0.3135105833375156,0.0014008758294709585),
    N3(0.5076314698365836,0.42127962040664924,0.0014340908858568075),
    N3(0.6357588286033857,0.27808727428667357,0.001517055590436915),
    N3(0.4642300352803425,0.27416822062930624,0.001530183989950572),
    N3(0.6599058902980668,0.20708611667553245,0.0015681877203027766),
    N3(0.38975253998077475,0.3737354618085531,0.00159315154188714),
    N3(0.5999448638615277,0.3116764564970622,0.001611373785291752),
    N3(0.4976571400045809,0.36598602074169806,0.0016714407161140925),
    N3(0.6991603249760958,0.1741043974705937,0.001754018549951184),
    N3(0.6563393658544058,0.24080874889460946,0.0017572876632114365),
    N3(0.6138955234102097,0.24933344689013004,0.0017697792757010525),
    N3(0.5610508712638271,0.35150817222447134,0.001842471730642425),
    N3(0.5172802722231575,0.39144032157708913,0.0018483709050950115),
    N3(0.4748327107106376,0.4330198941733229,0.001859072927084293),
    N3(0.6612254995252427,0.18279082193551793,0.0018993734205913595),
    N3(0.48871985266937434,0.39622279510862624,0.001942593276899558),
    N3(0.5765186069782064,0.2848454389827537,0.001968411369823964),
    N3(0.613507697861863,0.27526547406574753,0.001977394449831482),
    N3(0.5321831335829156,0.35550506553625805,0.0020025445296002697),
    N3(0.6221804774435724,0.21746243080312577,0.00216400732388828),
    N2(0.18770338511275142,0.002191078388277792),
    N3(0.5810329228008562,0.25363260930045745,0.0022180087381549517),
    N3(0.5339022616974847,0.3262178906870573,0.002235470044613763),
    N3(0.41721839247001535,0.38060797812177194,0.002271709901616132),
    N3(0.540360042499272,0.2924941504539766,0.002321883173308254),
    N3(0.5850278720963353,0.22223358649959157,0.0023291831099634323),
    N3(0.450403926720921,0.40742362185201,0.002359903401693172),
    N3(0.45390116992494955,0.3730804073587195,0.0023649810821195663),
    N3(0.5440343708820308,0.2586181029867432,0.002414216366903519),
    N3(0.4990071562930913,0.33116613109022086,0.002419042650183155),
    N2(0.41468698263126175,0.00247203735900228),
    N3(0.4631431686073328,0.3361629306600295,0.00247670956068938),
    N3(0.4239195459110478,0.339109372606681,0.002525326254984338),
    N3(0.5035674505793735,0.2966141791145545,0.0025424196600767504),
    N3(0.504705663098109,0.2637086794922689,0.0026034463908634893),
    N3(0.46429613344957704,0.3029218205486053,0.0026070429467254467),
    N3(0.424154908463325,0.3054354861265272,0.002774373324463886),
    N3(0.3839940781311476,0.34440839900593534,0.0028330099275198986),
    N2(0.3075574085596998,0.0028621507018141016),
    N2(0.3458625825039377,0.0028783376893923517) 
  };

  schemes.push_back(scheme(3, data3));
  schemes.push_back(scheme(5, data5));
  schemes.push_back(scheme(7, data7));
  schemes.push_back(scheme(9, data9));
  schemes.push_back(scheme(13, data13));
  schemes.push_back(scheme(17, data17));
  schemes.push_back(scheme(21, data21));
  schemes.push_back(scheme(25, data25));
  schemes.push_back(scheme(31, data31));
  schemes.push_back(scheme(37, data37));
  schemes.push_back(scheme(43, data43));
  schemes.push_back(scheme(49, data49));
  schemes.push_back(scheme(57, data57));
  schemes.push_back(scheme(65, data65));
  schemes.push_back(scheme(73, data73));
}

const scheme &scheme_selector::get_scheme(int n) const
{
  for (auto &s: schemes)
    if (s.order >= n)
      return s;
  return schemes.back();
}

int scheme_selector::max_order() const
{
  return schemes.back().order;
}

